(function () {
  "use strict";

  var url = require('url')
    ;

  function queryParser(req, res, next) {
    var urlObj = url.parse(req.url, true);

    if (req.query) {
      console.warn('req.query already exists:', req.query);
    }
    req.query = urlObj.query || {};

    if (req.pathname) {
      console.warn('req.pathname already exists:', req.pathname);
    }
    req.pathname = urlObj.pathname;

    next();
  }

  function create() {
    return queryParser;
  }

  module.exports = create;
}());
