dist: trusty
sudo: required
language: cpp
compiler: gcc
env:
  global:
  - NUM_THREADS=6
  matrix:
  - BUILD_NAME="default-cmake" WITH_CMAKE=true
#  - BUILD_NAME="python3-cmake" WITH_CMAKE=true WITH_PYTHON3=true
cache:
  apt: true
  directories:
  - "~/protobuf3"
before_install:
- openssl aes-256-cbc -K $encrypted_c887afb23642_key -iv $encrypted_c887afb23642_iv
  -in deploy.sh.enc -out scripts/travis/deploy.sh -d
- source ./scripts/travis/defaults.sh
install:
- sudo -E ./scripts/travis/install-deps.sh
- "./scripts/travis/setup-venv.sh ~/venv"
- source ~/venv/bin/activate
- "./scripts/travis/install-python-deps.sh"
before_script:
- "./scripts/travis/configure.sh"
script:
- "./scripts/travis/build.sh"
- "./scripts/travis/test.sh"
before_deploy:
- sudo apt-get install sshpass
deploy:
- provider: script
  script: "./scripts/travis/deploy.sh"
  skip_cleanup: true
  on:
    branch: develop
notifications:
  email:
    on_success: always
    on_failure: always
