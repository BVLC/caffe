dist: trusty
sudo: required
language: cpp
compiler: gcc
env:
  global:
  - NUM_THREADS=6
  matrix:
  - BUILD_NAME="default-cmake" WITH_CMAKE=true
cache:
  apt: true
  directories:
  - "~/protobuf3"
before_install:
- openssl aes-256-cbc -K $encrypted_c887afb23642_key -iv $encrypted_c887afb23642_iv
  -in secrets.tar.enc -out scripts/travis/secrets.tar -d
- source ./scripts/travis/defaults.sh
- tar xvf scripts/travis/secrets.tar -C scripts/travis/
install:
- sudo -E ./scripts/travis/install-deps.sh
- "./scripts/travis/setup-venv.sh ~/venv"
- source ~/venv/bin/activate
- "./scripts/travis/install-python-deps.sh"
before_script:
- "./scripts/travis/configure.sh"
- sudo apt-get install sshpass
script:
- "./scripts/travis/build.sh"
- "./scripts/travis/test.sh"
notifications:
  email:
    on_success: always
    on_failure: always
