<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Caffe: include/caffe/layer.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Caffe
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_4b7f3da7c7b4301d805dae0326fb91b7.html">caffe</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">layer.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef CAFFE_LAYER_H_</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define CAFFE_LAYER_H_</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;caffe/blob.hpp&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;caffe/common.hpp&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;caffe/layer_factory.hpp&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;caffe/proto/caffe.pb.h&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;caffe/util/math_functions.hpp&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceboost.html">boost</a> { <span class="keyword">class </span>mutex; }</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacecaffe.html">caffe</a> {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Dtype&gt;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html">   33</a></span>&#160;<span class="keyword">class </span><a class="code" href="classcaffe_1_1Layer.html">Layer</a> {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a7b4e4ccea08c7b8b15acc6829d5735f6">   40</a></span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classcaffe_1_1Layer.html#a7b4e4ccea08c7b8b15acc6829d5735f6">Layer</a>(<span class="keyword">const</span> LayerParameter&amp; param)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    : layer_param_(param), is_shared_(false) {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="comment">// Set phase and copy blobs (if there are any).</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      phase_ = param.phase();</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">if</span> (layer_param_.blobs_size() &gt; 0) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        blobs_.resize(layer_param_.blobs_size());</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; layer_param_.blobs_size(); ++i) {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;          blobs_[i].reset(<span class="keyword">new</span> <a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>());</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;          blobs_[i]-&gt;FromProto(layer_param_.blobs(i));</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        }</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keyword">virtual</span> ~<a class="code" href="classcaffe_1_1Layer.html">Layer</a>() {}</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#ac427a267f4c5ba93caac53b7ba64841d">   67</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html#ac427a267f4c5ba93caac53b7ba64841d">SetUp</a>(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    InitMutex();</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    CheckBlobCounts(bottom, top);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    LayerSetUp(bottom, top);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    Reshape(bottom, top);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    SetLossWeights(top);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a38dc2488bf319b8de5a7ac84e0045393">   92</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html#a38dc2488bf319b8de5a7ac84e0045393">LayerSetUp</a>(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top) {}</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a6ec5d3be0fc8348f8b67fccb697d4aa9">  101</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classcaffe_1_1Layer.html#a6ec5d3be0fc8348f8b67fccb697d4aa9">ShareInParallel</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a9dd73d843654bb15c9394ca2b43e8970">  107</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classcaffe_1_1Layer.html#a9dd73d843654bb15c9394ca2b43e8970">IsShared</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> is_shared_; }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a6d4caf38c9f0f31c9c92af1bbefc04e4">  113</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html#a6d4caf38c9f0f31c9c92af1bbefc04e4">SetShared</a>(<span class="keywordtype">bool</span> is_shared) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    CHECK(ShareInParallel() || !is_shared)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        &lt;&lt; type() &lt;&lt; <span class="stringliteral">&quot;Layer does not support sharing.&quot;</span>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    is_shared_ = is_shared;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> Reshape(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom,</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top) = 0;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keyword">inline</span> Dtype Forward(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> Backward(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keyword">const</span> vector&lt;bool&gt;&amp; propagate_down,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#aaf4524ce8641a30a8a4784aee1b2b4c8">  182</a></span>&#160;  vector&lt;shared_ptr&lt;Blob&lt;Dtype&gt; &gt; &gt;&amp; <a class="code" href="classcaffe_1_1Layer.html#aaf4524ce8641a30a8a4784aee1b2b4c8">blobs</a>() {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> blobs_;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#af475062fe280614b18f642c4ccf50b40">  189</a></span>&#160;  <span class="keyword">const</span> LayerParameter&amp; <a class="code" href="classcaffe_1_1Layer.html#af475062fe280614b18f642c4ccf50b40">layer_param</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> layer_param_; }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> ToProto(LayerParameter* param, <span class="keywordtype">bool</span> write_diff = <span class="keyword">false</span>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a964ccba33b9a4b69391a72508f764eaf">  199</a></span>&#160;  <span class="keyword">inline</span> Dtype <a class="code" href="classcaffe_1_1Layer.html#a964ccba33b9a4b69391a72508f764eaf">loss</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> top_index)<span class="keyword"> const </span>{</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">return</span> (loss_.size() &gt; top_index) ? loss_[top_index] : Dtype(0);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a899b09f4b91ada8545b3a43ee91e0d69">  206</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html#a899b09f4b91ada8545b3a43ee91e0d69">set_loss</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> top_index, <span class="keyword">const</span> Dtype value) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (loss_.size() &lt;= top_index) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      loss_.resize(top_index + 1, Dtype(0));</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    loss_[top_index] = value;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a8c5deb0263ae572036c564d53902a08d">  216</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classcaffe_1_1Layer.html#a8c5deb0263ae572036c564d53902a08d">type</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>; }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a45c7a7943a8a6735ac433c9be11e0240">  225</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classcaffe_1_1Layer.html#a45c7a7943a8a6735ac433c9be11e0240">ExactNumBottomBlobs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> -1; }</div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#ade3eee97cc743c4e68fff7eba6484916">  233</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classcaffe_1_1Layer.html#ade3eee97cc743c4e68fff7eba6484916">MinBottomBlobs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> -1; }</div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a6408ef3939f1abed1abcec46ff219289">  241</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classcaffe_1_1Layer.html#a6408ef3939f1abed1abcec46ff219289">MaxBottomBlobs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> -1; }</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#aa3c99ed707e8db683a3043412e151af8">  249</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classcaffe_1_1Layer.html#aa3c99ed707e8db683a3043412e151af8">ExactNumTopBlobs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> -1; }</div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a8bb143d58a740345fa2dc3d4204d553b">  257</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classcaffe_1_1Layer.html#a8bb143d58a740345fa2dc3d4204d553b">MinTopBlobs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> -1; }</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#adeff774663c6ec94424901d2746e2f03">  265</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classcaffe_1_1Layer.html#adeff774663c6ec94424901d2746e2f03">MaxTopBlobs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> -1; }</div><div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#ad412187a0483c310bd59fd5f957faf0d">  273</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classcaffe_1_1Layer.html#ad412187a0483c310bd59fd5f957faf0d">EqualNumBottomTopBlobs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#ad732ca94cb21b4c4e0d6372a530ededf">  283</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classcaffe_1_1Layer.html#ad732ca94cb21b4c4e0d6372a530ededf">AutoTopBlobs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a4a2e4ca94eaa1cbc054b512c6657743e">  293</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classcaffe_1_1Layer.html#a4a2e4ca94eaa1cbc054b512c6657743e">AllowForceBackward</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> bottom_index)<span class="keyword"> const </span>{</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a1a3708013b0231e71d725252e10ce6e3">  304</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classcaffe_1_1Layer.html#a1a3708013b0231e71d725252e10ce6e3">param_propagate_down</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> param_id) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">return</span> (param_propagate_down_.size() &gt; param_id) ?</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        param_propagate_down_[param_id] : <span class="keyword">false</span>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  }</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a9a6fcb843803ed556f0a69cc2864379b">  312</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html#a9a6fcb843803ed556f0a69cc2864379b">set_param_propagate_down</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> param_id, <span class="keyword">const</span> <span class="keywordtype">bool</span> value) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> (param_propagate_down_.size() &lt;= param_id) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      param_propagate_down_.resize(param_id + 1, <span class="keyword">true</span>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    param_propagate_down_[param_id] = value;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a7ed12bb2df25c887e41d7ea9557fc701">  322</a></span>&#160;  LayerParameter <a class="code" href="classcaffe_1_1Layer.html#a7ed12bb2df25c887e41d7ea9557fc701">layer_param_</a>;</div><div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a1d04ad7f595a82a1c811f102d68b8a19">  324</a></span>&#160;  Phase <a class="code" href="classcaffe_1_1Layer.html#a1d04ad7f595a82a1c811f102d68b8a19">phase_</a>;</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a8073fcf2c139b47eb99ce71b346b1321">  326</a></span>&#160;  vector&lt;shared_ptr&lt;Blob&lt;Dtype&gt; &gt; &gt; <a class="code" href="classcaffe_1_1Layer.html#a8073fcf2c139b47eb99ce71b346b1321">blobs_</a>;</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#acd4a05def9ff3b42ad72404210613ef7">  328</a></span>&#160;  vector&lt;bool&gt; <a class="code" href="classcaffe_1_1Layer.html#acd4a05def9ff3b42ad72404210613ef7">param_propagate_down_</a>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#af6d347229a139500994e7a926c680486">  332</a></span>&#160;  vector&lt;Dtype&gt; <a class="code" href="classcaffe_1_1Layer.html#af6d347229a139500994e7a926c680486">loss_</a>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> Forward_cpu(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top) = 0;</div><div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a93b8d8c30c7691a39f634bf7bb2b03fb">  341</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html#a93b8d8c30c7691a39f634bf7bb2b03fb">Forward_gpu</a>(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// LOG(WARNING) &lt;&lt; &quot;Using CPU code as backup.&quot;;</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">return</span> Forward_cpu(bottom, top);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> Backward_cpu(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keyword">const</span> vector&lt;bool&gt;&amp; propagate_down,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom) = 0;</div><div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a9275e5b8196feac9cf22803973c890f9">  359</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html#a9275e5b8196feac9cf22803973c890f9">Backward_gpu</a>(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keyword">const</span> vector&lt;bool&gt;&amp; propagate_down,</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// LOG(WARNING) &lt;&lt; &quot;Using CPU code as backup.&quot;;</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    Backward_cpu(top, propagate_down, bottom);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#adaa95e30dff155409a25ffcb5c8c885e">  371</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html#adaa95e30dff155409a25ffcb5c8c885e">CheckBlobCounts</a>(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom,</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                               <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top) {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">if</span> (ExactNumBottomBlobs() &gt;= 0) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      CHECK_EQ(ExactNumBottomBlobs(), bottom.size())</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          &lt;&lt; type() &lt;&lt; <span class="stringliteral">&quot; Layer takes &quot;</span> &lt;&lt; ExactNumBottomBlobs()</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; bottom blob(s) as input.&quot;</span>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (MinBottomBlobs() &gt;= 0) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      CHECK_LE(MinBottomBlobs(), bottom.size())</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          &lt;&lt; type() &lt;&lt; <span class="stringliteral">&quot; Layer takes at least &quot;</span> &lt;&lt; MinBottomBlobs()</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; bottom blob(s) as input.&quot;</span>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (MaxBottomBlobs() &gt;= 0) {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      CHECK_GE(MaxBottomBlobs(), bottom.size())</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          &lt;&lt; type() &lt;&lt; <span class="stringliteral">&quot; Layer takes at most &quot;</span> &lt;&lt; MaxBottomBlobs()</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; bottom blob(s) as input.&quot;</span>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (ExactNumTopBlobs() &gt;= 0) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      CHECK_EQ(ExactNumTopBlobs(), top.size())</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          &lt;&lt; type() &lt;&lt; <span class="stringliteral">&quot; Layer produces &quot;</span> &lt;&lt; ExactNumTopBlobs()</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; top blob(s) as output.&quot;</span>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">if</span> (MinTopBlobs() &gt;= 0) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      CHECK_LE(MinTopBlobs(), top.size())</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          &lt;&lt; type() &lt;&lt; <span class="stringliteral">&quot; Layer produces at least &quot;</span> &lt;&lt; MinTopBlobs()</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; top blob(s) as output.&quot;</span>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">if</span> (MaxTopBlobs() &gt;= 0) {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      CHECK_GE(MaxTopBlobs(), top.size())</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          &lt;&lt; type() &lt;&lt; <span class="stringliteral">&quot; Layer produces at most &quot;</span> &lt;&lt; MaxTopBlobs()</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; top blob(s) as output.&quot;</span>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">if</span> (EqualNumBottomTopBlobs()) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      CHECK_EQ(bottom.size(), top.size())</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          &lt;&lt; type() &lt;&lt; <span class="stringliteral">&quot; Layer produces one top blob as output for each &quot;</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;bottom blob input.&quot;</span>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a8bd62d1505dd35d6a3a25954ae9e6014">  414</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html#a8bd62d1505dd35d6a3a25954ae9e6014">SetLossWeights</a>(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_loss_weights = layer_param_.loss_weight_size();</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">if</span> (num_loss_weights) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      CHECK_EQ(top.size(), num_loss_weights) &lt;&lt; <span class="stringliteral">&quot;loss_weight must be &quot;</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;          <span class="stringliteral">&quot;unspecified or specified once per top blob.&quot;</span>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> top_id = 0; top_id &lt; top.size(); ++top_id) {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keyword">const</span> Dtype loss_weight = layer_param_.loss_weight(top_id);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordflow">if</span> (loss_weight == Dtype(0)) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        this-&gt;set_loss(top_id, loss_weight);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> count = top[top_id]-&gt;count();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        Dtype* loss_multiplier = top[top_id]-&gt;mutable_cpu_diff();</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        caffe_set(count, loss_weight, loss_multiplier);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordtype">bool</span> is_shared_;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  shared_ptr&lt;boost::mutex&gt; forward_mutex_;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordtype">void</span> InitMutex();</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordtype">void</span> Lock();</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordtype">void</span> Unlock();</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  DISABLE_COPY_AND_ASSIGN(<a class="code" href="classcaffe_1_1Layer.html">Layer</a>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;};  <span class="comment">// class Layer</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">// Forward and backward wrappers. You should implement the cpu and</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">// gpu specific implementations instead, and should not change these</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">// functions.</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Dtype&gt;</div><div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#aa5fc9ddb31b58958653372bdaaccde94">  451</a></span>&#160;<span class="keyword">inline</span> Dtype <a class="code" href="classcaffe_1_1Layer.html">Layer&lt;Dtype&gt;::Forward</a>(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom,</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// Lock during forward to ensure sequential forward</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  Lock();</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  Dtype loss = 0;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  Reshape(bottom, top);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">switch</span> (Caffe::mode()) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">case</span> Caffe::CPU:</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    Forward_cpu(bottom, top);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> top_id = 0; top_id &lt; top.size(); ++top_id) {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;loss(top_id)) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> count = top[top_id]-&gt;count();</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keyword">const</span> Dtype* data = top[top_id]-&gt;cpu_data();</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keyword">const</span> Dtype* loss_weights = top[top_id]-&gt;cpu_diff();</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      loss += caffe_cpu_dot(count, data, loss_weights);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">case</span> Caffe::GPU:</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    Forward_gpu(bottom, top);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor">#ifndef CPU_ONLY</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> top_id = 0; top_id &lt; top.size(); ++top_id) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;loss(top_id)) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> count = top[top_id]-&gt;count();</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keyword">const</span> Dtype* data = top[top_id]-&gt;gpu_data();</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keyword">const</span> Dtype* loss_weights = top[top_id]-&gt;gpu_diff();</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      Dtype blob_loss = 0;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      caffe_gpu_dot(count, data, loss_weights, &amp;blob_loss);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      loss += blob_loss;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;Unknown caffe mode.&quot;</span>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  Unlock();</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">return</span> loss;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Dtype&gt;</div><div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a53df1e081767e07bfb4c81657f4acd0a">  490</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html">Layer&lt;Dtype&gt;::Backward</a>(<span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; top,</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keyword">const</span> vector&lt;bool&gt;&amp; propagate_down,</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keyword">const</span> vector&lt;<a class="code" href="classcaffe_1_1Blob.html">Blob&lt;Dtype&gt;</a>*&gt;&amp; bottom) {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">switch</span> (Caffe::mode()) {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">case</span> Caffe::CPU:</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    Backward_cpu(top, propagate_down, bottom);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">case</span> Caffe::GPU:</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    Backward_gpu(top, propagate_down, bottom);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;Unknown caffe mode.&quot;</span>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">// Serialize LayerParameter to protocol buffer</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Dtype&gt;</div><div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="classcaffe_1_1Layer.html#a4a1754828dda22cc8daa2f63377f3579">  507</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcaffe_1_1Layer.html">Layer&lt;Dtype&gt;::ToProto</a>(LayerParameter* param, <span class="keywordtype">bool</span> write_diff) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  param-&gt;Clear();</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  param-&gt;CopyFrom(layer_param_);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  param-&gt;clear_blobs();</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; blobs_.size(); ++i) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    blobs_[i]-&gt;<a class="code" href="classcaffe_1_1Layer.html#a4a1754828dda22cc8daa2f63377f3579">ToProto</a>(param-&gt;add_blobs(), write_diff);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  }</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}  <span class="comment">// namespace caffe</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">#endif  // CAFFE_LAYER_H_</span></div><div class="ttc" id="classcaffe_1_1Layer_html_af6d347229a139500994e7a926c680486"><div class="ttname"><a href="classcaffe_1_1Layer.html#af6d347229a139500994e7a926c680486">caffe::Layer::loss_</a></div><div class="ttdeci">vector&lt; Dtype &gt; loss_</div><div class="ttdef"><b>Definition:</b> layer.hpp:332</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html"><div class="ttname"><a href="classcaffe_1_1Layer.html">caffe::Layer</a></div><div class="ttdoc">An interface for the units of computation which can be composed into a Net. </div><div class="ttdef"><b>Definition:</b> layer.hpp:33</div></div>
<div class="ttc" id="namespacecaffe_html"><div class="ttname"><a href="namespacecaffe.html">caffe</a></div><div class="ttdoc">A layer factory that allows one to register layers. During runtime, registered layers can be called b...</div><div class="ttdef"><b>Definition:</b> blob.hpp:14</div></div>
<div class="ttc" id="namespaceboost_html"><div class="ttname"><a href="namespaceboost.html">boost</a></div><div class="ttdef"><b>Definition:</b> internal_thread.hpp:10</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_ade3eee97cc743c4e68fff7eba6484916"><div class="ttname"><a href="classcaffe_1_1Layer.html#ade3eee97cc743c4e68fff7eba6484916">caffe::Layer::MinBottomBlobs</a></div><div class="ttdeci">virtual int MinBottomBlobs() const </div><div class="ttdoc">Returns the minimum number of bottom blobs required by the layer, or -1 if no minimum number is requi...</div><div class="ttdef"><b>Definition:</b> layer.hpp:233</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_ad412187a0483c310bd59fd5f957faf0d"><div class="ttname"><a href="classcaffe_1_1Layer.html#ad412187a0483c310bd59fd5f957faf0d">caffe::Layer::EqualNumBottomTopBlobs</a></div><div class="ttdeci">virtual bool EqualNumBottomTopBlobs() const </div><div class="ttdoc">Returns true if the layer requires an equal number of bottom and top blobs. </div><div class="ttdef"><b>Definition:</b> layer.hpp:273</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a8073fcf2c139b47eb99ce71b346b1321"><div class="ttname"><a href="classcaffe_1_1Layer.html#a8073fcf2c139b47eb99ce71b346b1321">caffe::Layer::blobs_</a></div><div class="ttdeci">vector&lt; shared_ptr&lt; Blob&lt; Dtype &gt; &gt; &gt; blobs_</div><div class="ttdef"><b>Definition:</b> layer.hpp:326</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_af475062fe280614b18f642c4ccf50b40"><div class="ttname"><a href="classcaffe_1_1Layer.html#af475062fe280614b18f642c4ccf50b40">caffe::Layer::layer_param</a></div><div class="ttdeci">const LayerParameter &amp; layer_param() const </div><div class="ttdoc">Returns the layer parameter. </div><div class="ttdef"><b>Definition:</b> layer.hpp:189</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_aa3c99ed707e8db683a3043412e151af8"><div class="ttname"><a href="classcaffe_1_1Layer.html#aa3c99ed707e8db683a3043412e151af8">caffe::Layer::ExactNumTopBlobs</a></div><div class="ttdeci">virtual int ExactNumTopBlobs() const </div><div class="ttdoc">Returns the exact number of top blobs required by the layer, or -1 if no exact number is required...</div><div class="ttdef"><b>Definition:</b> layer.hpp:249</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_ad732ca94cb21b4c4e0d6372a530ededf"><div class="ttname"><a href="classcaffe_1_1Layer.html#ad732ca94cb21b4c4e0d6372a530ededf">caffe::Layer::AutoTopBlobs</a></div><div class="ttdeci">virtual bool AutoTopBlobs() const </div><div class="ttdoc">Return whether &quot;anonymous&quot; top blobs are created automatically by the layer. </div><div class="ttdef"><b>Definition:</b> layer.hpp:283</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a9dd73d843654bb15c9394ca2b43e8970"><div class="ttname"><a href="classcaffe_1_1Layer.html#a9dd73d843654bb15c9394ca2b43e8970">caffe::Layer::IsShared</a></div><div class="ttdeci">bool IsShared() const </div><div class="ttdoc">Return whether this layer is actually shared by other nets. If ShareInParallel() is true and using mo...</div><div class="ttdef"><b>Definition:</b> layer.hpp:107</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a93b8d8c30c7691a39f634bf7bb2b03fb"><div class="ttname"><a href="classcaffe_1_1Layer.html#a93b8d8c30c7691a39f634bf7bb2b03fb">caffe::Layer::Forward_gpu</a></div><div class="ttdeci">virtual void Forward_gpu(const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;bottom, const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;top)</div><div class="ttdoc">Using the GPU device, compute the layer output. Fall back to Forward_cpu() if unavailable. </div><div class="ttdef"><b>Definition:</b> layer.hpp:341</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a964ccba33b9a4b69391a72508f764eaf"><div class="ttname"><a href="classcaffe_1_1Layer.html#a964ccba33b9a4b69391a72508f764eaf">caffe::Layer::loss</a></div><div class="ttdeci">Dtype loss(const int top_index) const </div><div class="ttdoc">Returns the scalar loss associated with a top blob at a given index. </div><div class="ttdef"><b>Definition:</b> layer.hpp:199</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_aaf4524ce8641a30a8a4784aee1b2b4c8"><div class="ttname"><a href="classcaffe_1_1Layer.html#aaf4524ce8641a30a8a4784aee1b2b4c8">caffe::Layer::blobs</a></div><div class="ttdeci">vector&lt; shared_ptr&lt; Blob&lt; Dtype &gt; &gt; &gt; &amp; blobs()</div><div class="ttdoc">Returns the vector of learnable parameter blobs. </div><div class="ttdef"><b>Definition:</b> layer.hpp:182</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_adeff774663c6ec94424901d2746e2f03"><div class="ttname"><a href="classcaffe_1_1Layer.html#adeff774663c6ec94424901d2746e2f03">caffe::Layer::MaxTopBlobs</a></div><div class="ttdeci">virtual int MaxTopBlobs() const </div><div class="ttdoc">Returns the maximum number of top blobs required by the layer, or -1 if no maximum number is required...</div><div class="ttdef"><b>Definition:</b> layer.hpp:265</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_adaa95e30dff155409a25ffcb5c8c885e"><div class="ttname"><a href="classcaffe_1_1Layer.html#adaa95e30dff155409a25ffcb5c8c885e">caffe::Layer::CheckBlobCounts</a></div><div class="ttdeci">virtual void CheckBlobCounts(const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;bottom, const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;top)</div><div class="ttdef"><b>Definition:</b> layer.hpp:371</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a6d4caf38c9f0f31c9c92af1bbefc04e4"><div class="ttname"><a href="classcaffe_1_1Layer.html#a6d4caf38c9f0f31c9c92af1bbefc04e4">caffe::Layer::SetShared</a></div><div class="ttdeci">void SetShared(bool is_shared)</div><div class="ttdoc">Set whether this layer is actually shared by other nets If ShareInParallel() is true and using more t...</div><div class="ttdef"><b>Definition:</b> layer.hpp:113</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a4a2e4ca94eaa1cbc054b512c6657743e"><div class="ttname"><a href="classcaffe_1_1Layer.html#a4a2e4ca94eaa1cbc054b512c6657743e">caffe::Layer::AllowForceBackward</a></div><div class="ttdeci">virtual bool AllowForceBackward(const int bottom_index) const </div><div class="ttdoc">Return whether to allow force_backward for a given bottom blob index. </div><div class="ttdef"><b>Definition:</b> layer.hpp:293</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_acd4a05def9ff3b42ad72404210613ef7"><div class="ttname"><a href="classcaffe_1_1Layer.html#acd4a05def9ff3b42ad72404210613ef7">caffe::Layer::param_propagate_down_</a></div><div class="ttdeci">vector&lt; bool &gt; param_propagate_down_</div><div class="ttdef"><b>Definition:</b> layer.hpp:328</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a8bd62d1505dd35d6a3a25954ae9e6014"><div class="ttname"><a href="classcaffe_1_1Layer.html#a8bd62d1505dd35d6a3a25954ae9e6014">caffe::Layer::SetLossWeights</a></div><div class="ttdeci">void SetLossWeights(const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;top)</div><div class="ttdef"><b>Definition:</b> layer.hpp:414</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a9a6fcb843803ed556f0a69cc2864379b"><div class="ttname"><a href="classcaffe_1_1Layer.html#a9a6fcb843803ed556f0a69cc2864379b">caffe::Layer::set_param_propagate_down</a></div><div class="ttdeci">void set_param_propagate_down(const int param_id, const bool value)</div><div class="ttdoc">Sets whether the layer should compute gradients w.r.t. a parameter at a particular index given by par...</div><div class="ttdef"><b>Definition:</b> layer.hpp:312</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a8bb143d58a740345fa2dc3d4204d553b"><div class="ttname"><a href="classcaffe_1_1Layer.html#a8bb143d58a740345fa2dc3d4204d553b">caffe::Layer::MinTopBlobs</a></div><div class="ttdeci">virtual int MinTopBlobs() const </div><div class="ttdoc">Returns the minimum number of top blobs required by the layer, or -1 if no minimum number is required...</div><div class="ttdef"><b>Definition:</b> layer.hpp:257</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a45c7a7943a8a6735ac433c9be11e0240"><div class="ttname"><a href="classcaffe_1_1Layer.html#a45c7a7943a8a6735ac433c9be11e0240">caffe::Layer::ExactNumBottomBlobs</a></div><div class="ttdeci">virtual int ExactNumBottomBlobs() const </div><div class="ttdoc">Returns the exact number of bottom blobs required by the layer, or -1 if no exact number is required...</div><div class="ttdef"><b>Definition:</b> layer.hpp:225</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a8c5deb0263ae572036c564d53902a08d"><div class="ttname"><a href="classcaffe_1_1Layer.html#a8c5deb0263ae572036c564d53902a08d">caffe::Layer::type</a></div><div class="ttdeci">virtual const char * type() const </div><div class="ttdoc">Returns the layer type. </div><div class="ttdef"><b>Definition:</b> layer.hpp:216</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a7b4e4ccea08c7b8b15acc6829d5735f6"><div class="ttname"><a href="classcaffe_1_1Layer.html#a7b4e4ccea08c7b8b15acc6829d5735f6">caffe::Layer::Layer</a></div><div class="ttdeci">Layer(const LayerParameter &amp;param)</div><div class="ttdef"><b>Definition:</b> layer.hpp:40</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a6ec5d3be0fc8348f8b67fccb697d4aa9"><div class="ttname"><a href="classcaffe_1_1Layer.html#a6ec5d3be0fc8348f8b67fccb697d4aa9">caffe::Layer::ShareInParallel</a></div><div class="ttdeci">virtual bool ShareInParallel() const </div><div class="ttdoc">Whether a layer should be shared by multiple nets during data parallelism. By default, all layers except for data layers should not be shared. data layers should be shared to ensure each worker solver access data sequentially during data parallelism. </div><div class="ttdef"><b>Definition:</b> layer.hpp:101</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a38dc2488bf319b8de5a7ac84e0045393"><div class="ttname"><a href="classcaffe_1_1Layer.html#a38dc2488bf319b8de5a7ac84e0045393">caffe::Layer::LayerSetUp</a></div><div class="ttdeci">virtual void LayerSetUp(const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;bottom, const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;top)</div><div class="ttdoc">Does layer-specific setup: your layer should implement this function as well as Reshape. </div><div class="ttdef"><b>Definition:</b> layer.hpp:92</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a4a1754828dda22cc8daa2f63377f3579"><div class="ttname"><a href="classcaffe_1_1Layer.html#a4a1754828dda22cc8daa2f63377f3579">caffe::Layer::ToProto</a></div><div class="ttdeci">virtual void ToProto(LayerParameter *param, bool write_diff=false)</div><div class="ttdoc">Writes the layer parameter to a protocol buffer. </div><div class="ttdef"><b>Definition:</b> layer.hpp:507</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a1d04ad7f595a82a1c811f102d68b8a19"><div class="ttname"><a href="classcaffe_1_1Layer.html#a1d04ad7f595a82a1c811f102d68b8a19">caffe::Layer::phase_</a></div><div class="ttdeci">Phase phase_</div><div class="ttdef"><b>Definition:</b> layer.hpp:324</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a7ed12bb2df25c887e41d7ea9557fc701"><div class="ttname"><a href="classcaffe_1_1Layer.html#a7ed12bb2df25c887e41d7ea9557fc701">caffe::Layer::layer_param_</a></div><div class="ttdeci">LayerParameter layer_param_</div><div class="ttdef"><b>Definition:</b> layer.hpp:322</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a899b09f4b91ada8545b3a43ee91e0d69"><div class="ttname"><a href="classcaffe_1_1Layer.html#a899b09f4b91ada8545b3a43ee91e0d69">caffe::Layer::set_loss</a></div><div class="ttdeci">void set_loss(const int top_index, const Dtype value)</div><div class="ttdoc">Sets the loss associated with a top blob at a given index. </div><div class="ttdef"><b>Definition:</b> layer.hpp:206</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_ac427a267f4c5ba93caac53b7ba64841d"><div class="ttname"><a href="classcaffe_1_1Layer.html#ac427a267f4c5ba93caac53b7ba64841d">caffe::Layer::SetUp</a></div><div class="ttdeci">void SetUp(const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;bottom, const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;top)</div><div class="ttdoc">Implements common layer setup functionality. </div><div class="ttdef"><b>Definition:</b> layer.hpp:67</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a6408ef3939f1abed1abcec46ff219289"><div class="ttname"><a href="classcaffe_1_1Layer.html#a6408ef3939f1abed1abcec46ff219289">caffe::Layer::MaxBottomBlobs</a></div><div class="ttdeci">virtual int MaxBottomBlobs() const </div><div class="ttdoc">Returns the maximum number of bottom blobs required by the layer, or -1 if no maximum number is requi...</div><div class="ttdef"><b>Definition:</b> layer.hpp:241</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a9275e5b8196feac9cf22803973c890f9"><div class="ttname"><a href="classcaffe_1_1Layer.html#a9275e5b8196feac9cf22803973c890f9">caffe::Layer::Backward_gpu</a></div><div class="ttdeci">virtual void Backward_gpu(const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;top, const vector&lt; bool &gt; &amp;propagate_down, const vector&lt; Blob&lt; Dtype &gt; * &gt; &amp;bottom)</div><div class="ttdoc">Using the GPU device, compute the gradients for any parameters and for the bottom blobs if propagate_...</div><div class="ttdef"><b>Definition:</b> layer.hpp:359</div></div>
<div class="ttc" id="classcaffe_1_1Layer_html_a1a3708013b0231e71d725252e10ce6e3"><div class="ttname"><a href="classcaffe_1_1Layer.html#a1a3708013b0231e71d725252e10ce6e3">caffe::Layer::param_propagate_down</a></div><div class="ttdeci">bool param_propagate_down(const int param_id)</div><div class="ttdoc">Specifies whether the layer should compute gradients w.r.t. a parameter at a particular index given b...</div><div class="ttdef"><b>Definition:</b> layer.hpp:304</div></div>
<div class="ttc" id="classcaffe_1_1Blob_html"><div class="ttname"><a href="classcaffe_1_1Blob.html">caffe::Blob</a></div><div class="ttdoc">A wrapper around SyncedMemory holders serving as the basic computational unit through which Layers...</div><div class="ttdef"><b>Definition:</b> blob.hpp:24</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Sep 16 2016 21:51:36 for Caffe by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
